\section{The algorithm, and proof of \cref{thm:main}}